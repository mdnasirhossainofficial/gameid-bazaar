<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard - GameID Bazaar</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
</head>
<body>
  <div class="container">
    <h2>Welcome to GameID Bazaar Dashboard</h2>
    <div id="content"></div>
    <button id="logout-btn">Logout</button>
  </div>

  <script>
    // Firebase config (তোমার সেটিংস বসাও)
    const firebaseConfig = {
      apiKey: "AIzaSyCkHH8U_zgWQ01SLLhqrnxhe8j6KjnM9Q0",
      authDomain: "bismillah-telecom-ed960.firebaseapp.com",
      databaseURL: "https://bismillah-telecom-ed960-default-rtdb.firebaseio.com",
      projectId: "bismillah-telecom-ed960",
      storageBucket: "bismillah-telecom-ed960.appspot.com",
      messagingSenderId: "163310183508",
      appId: "1:163310183508:web:036a2421c0cd3c264079c1"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    const contentDiv = document.getElementById('content');
    const logoutBtn = document.getElementById('logout-btn');

    // Check auth state
    auth.onAuthStateChanged(user => {
      if(user) {
        // ইউজারের uid নাও
        const uid = user.uid;

        // ডাটাবেস থেকে role নাও
        db.ref('users/' + uid).once('value')
          .then(snapshot => {
            const userData = snapshot.val();

            if(!userData) {
              contentDiv.innerHTML = `<p>User data not found.</p>`;
              return;
            }

            if(userData.role === 'admin') {
              // Admin content
              contentDiv.innerHTML = `
                <h3>Admin Dashboard</h3>
                <p>Welcome, Admin <strong>${user.email}</strong></p>
                <p>You have full control over the site.</p>
                <button onclick="manageUsers()">Manage Users</button>
              `;
            } else {
              // Normal user content
              contentDiv.innerHTML = `
                <h3>User Dashboard</h3>
                <p>Welcome, <strong>${user.email}</strong></p>
                <p>Browse available game IDs and make purchases.</p>
              `;
            }
          })
          .catch(err => {
            contentDiv.innerHTML = `<p>Error loading user data: ${err.message}</p>`;
          });
      } else {
        // যদি লগইন না থাকে, লগইন পেজে redirect করো
        window.location.href = 'login.html';
      }
    });

    // Logout
    logoutBtn.addEventListener('click', () => {
      auth.signOut().then(() => {
        window.location.href = 'login.html';
      });
    });

    // অ্যাডমিন ইউজার ম্যানেজমেন্টের জন্য একটি উদাহরণ ফাংশন
    function manageUsers() {
      alert("This is where you manage users (Implement as needed).");
    }
  </script>
</body>
</html>
